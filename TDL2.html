<!DOCTYPE html>
<html lang="en">
 <head>
   <meta charset="UTF-8" />
   <title>To Do List</title>
   <link
     href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
     rel="stylesheet"
   />
   <style>
     body {
       margin: 0;
       padding: 0;
       font-family: sans-serif;
     }

     .container-fluid {
       padding: 0;
     }

     .design-bar button,
     .design-bar input[type="color"] {
       margin-right: 5px;
       border-radius: 5px;
       padding: 5px 10px;
       border: 1px solid #ccc;
     }

     .design-bar input[type="color"] {
       padding: 0;
       width: 40px;
       height: 38px;
       border: none;
     }

     .design-bar button {
       background-color: #007bff;
       color: #fff;
     }

     .btn {
       border-radius: 5px;
     }

     .task-bar,
     .subtask-bar {
       background-color: #f8f9fa;
       padding: 10px;
       margin-bottom: 10px;
       border: 1px solid #ccc;
       border-radius: 5px;
     }

     .task-bar {
       width: 100%;
     }

     .subtask-bar {
       width: 90%;
       margin-left: 10%;
     }

     .task-content,
     .subtask-content {
       width: 100%;
       min-height: 50px;
       font-size: 16px;
       border: none;
       background: transparent;
       outline: none;
     }

     .task-content[placeholder]:empty:before,
     .subtask-content[placeholder]:empty:before {
       content: attr(placeholder);
       color: #999;
     }

     .task-content,
     .subtask-content {
       resize: none;
       overflow: hidden;
     }

     .progress {
       margin-bottom: 10px;
     }

     .status-label {
       display: inline-block;
       padding: 5px 10px;
       border-radius: 5px;
       font-weight: bold;
       margin-bottom: 5px;
     }

     .status-label.complete {
       background-color: #28a745;
       color: #fff;
     }

     .status-label.uncomplete {
       background-color: #dc3545;
       color: #fff;
     }

     .dark-mode {
       background-color: #333 !important;
       color: #fff !important;
     }

     .dark-mode .task-bar,
     .dark-mode .subtask-bar {
       background-color: #444;
       border-color: #555;
     }

     .dark-mode .list-group-item {
       background-color: #333;
       color: #fff;
     }

     .list-group-item.active {
       background-color: #007bff;
       border-color: #007bff;
     }

     .list-group-item {
       border: none;
       border-radius: 0;
     }

     .list-group-item:not(:last-child) {
       border-bottom: 1px solid #ccc;
     }
   </style>
 </head>
 <body>
   <div class="container-fluid">
     <!-- Progress Bar -->
     <div id="progressContainer" class="row">
       <div class="col">
         <div class="progress">
           <div
             id="progressBar"
             class="progress-bar"
             role="progressbar"
             style="width: 0%"
           ></div>
         </div>
       </div>
     </div>
     <!-- Sidebar -->
     <div class="row">
       <div class="col-md-2">
         <ul class="list-group">
           <li
             class="list-group-item active"
             onclick="showToDo()"
             id="todoButton"
           >
             To Do List
           </li>
           <li
             class="list-group-item"
             onclick="showHistory()"
             id="historyButton"
           >
             History
           </li>
           <li
             class="list-group-item"
             onclick="showDesign()"
             id="designButton"
           >
             Design
           </li>
         </ul>
       </div>
       <div class="col-md-10">
         <!-- Formatting -->
         <div class="design-bar mb-2">
           <button
             onclick="formatText('bold')"
             onmousedown="event.preventDefault()"
           >
             Bold
           </button>
           <button
             onclick="formatText('italic')"
             onmousedown="event.preventDefault()"
           >
             Italic
           </button>
           <input
             type="color"
             id="colorPicker"
             onchange="changeTextColor(this.value)"
             title="Choose Color"
           />
         </div>
         <!-- Add Task-->
         <button class="btn btn-primary mb-2" onclick="addTask()">
           Add Task
         </button>
         <div id="contentArea">
           <!-- Task List -->
           <div id="taskList"></div>
           <!-- History-->
           <div id="historyContent" style="display: none"></div>
           <!-- Design -->
           <div id="designContent" style="display: none"></div>
         </div>
       </div>
     </div>
   </div>
   <script>
     let taskCounter = 0;
     let totalTasks = 0;
     let completedTasks = 0;
     let history = [];
     let selectedColor = "#000000";

     function autoResizeDiv(div) {
       div.style.height = "auto";
       div.style.height = div.scrollHeight + "px";
     }

     function addTask() {
       totalTasks++;
       let taskId = "task" + taskCounter++;
       let taskDiv = document.createElement("div");
       taskDiv.className = "task-bar";
       taskDiv.id = taskId;
       taskDiv.dataset.completed = "false";

       // Auto-generate the creation date
       const creationDate = new Date().toLocaleDateString();

       taskDiv.innerHTML = `
       <div contenteditable="true" class="task-content" placeholder="New Task"></div>
       <div>
           <label>Creation Date: </label><span>${creationDate}</span>
       </div>
       <div>
           <label>Due Date:</label>
           <input type="date" class="due-date" onchange="updateDueDate('${taskId}', this.value)">
       </div>
       <div class="text-right mt-2">
           <button class="btn btn-secondary" onclick="addSubtask('${taskId}')">Add Subtask</button>
           <button class="btn btn-secondary" onclick="editTask('${taskId}', this)">Save</button>
           <button class="btn btn-success" onclick="completeTask('${taskId}', this)">Complete</button>
           <button class="btn btn-danger" onclick="deleteTask('${taskId}')">Delete</button>
       </div>
   `;
       document.getElementById("taskList").appendChild(taskDiv);

       let contentDiv = taskDiv.querySelector(".task-content");
       contentDiv.style.color = selectedColor;
       contentDiv.addEventListener("input", function () {
         autoResizeDiv(contentDiv);
       });
       contentDiv.focus();

       // Log creation with the creation date
       logHistory("Created task", `New Task (created on ${creationDate})`);
     }

     function addSubtask(parentId) {
       let subtaskDiv = document.createElement("div");
       subtaskDiv.className = "subtask-bar";
       subtaskDiv.dataset.completed = "false";
       subtaskDiv.innerHTML = `
   <div contenteditable="true" class="subtask-content" placeholder="New Subtask"></div>
   <div class="status-label uncomplete">Uncomplete</div>
   <div class="text-right mt-2">
     <button class="btn btn-secondary" onclick="editSubtask(this)">Save</button>
     <button class="btn btn-success" onclick="completeSubtask(this)">Complete</button>
     <button class="btn btn-danger" onclick="deleteSubtask(this)">Delete</button>
   </div>
 `;
       let parentDiv = document.getElementById(parentId);
       parentDiv.appendChild(subtaskDiv);
       let contentDiv = subtaskDiv.querySelector(".subtask-content");
       contentDiv.style.color = selectedColor;
       contentDiv.addEventListener("input", function () {
         autoResizeDiv(contentDiv);
       });
       contentDiv.addEventListener("focus", function () {
         document.execCommand("foreColor", false, selectedColor);
       });
       contentDiv.focus();
       // Do not log history here; wait until the subtask is saved
     }

     function deleteTask(taskId) {
       let taskElement = document.getElementById(taskId);
       let taskName =
         taskElement.querySelector(".task-content").textContent ||
         "Unnamed Task";
       if (taskElement.dataset.completed === "true") {
         completedTasks--;
       }
       totalTasks--;
       taskElement.remove();
       updateProgress();
       logHistory("Deleted task", taskName);
     }

     function deleteSubtask(button) {
       let subtaskElement = button.parentElement.parentElement;
       let subtaskName =
         subtaskElement.querySelector(".subtask-content").textContent ||
         "Unnamed Subtask";
       subtaskElement.remove();
       logHistory("Deleted subtask", subtaskName);

       let parentTaskId = subtaskElement.parentElement.id;
       checkTaskCompletion(parentTaskId);
     }

     function editTask(taskId, button) {
       let taskDiv = document.getElementById(taskId);
       let contentDiv = taskDiv.querySelector(".task-content");
       if (contentDiv.isContentEditable) {
         contentDiv.contentEditable = "false";
         button.textContent = "Edit";
         let taskName = contentDiv.textContent || "Unnamed Task";
         logHistory("Saved task", taskName);
       } else {
         contentDiv.contentEditable = "true";
         contentDiv.focus();
         document.execCommand("foreColor", false, selectedColor);
         button.textContent = "Save";
       }
     }

     function editSubtask(button) {
       let subtaskDiv = button.parentElement.parentElement;
       let contentDiv = subtaskDiv.querySelector(".subtask-content");
       if (contentDiv.isContentEditable) {
         contentDiv.contentEditable = "false";
         button.textContent = "Edit";
         let subtaskName = contentDiv.textContent || "Unnamed Subtask";
         logHistory("Saved subtask", subtaskName);
       } else {
         contentDiv.contentEditable = "true";
         contentDiv.focus();
         document.execCommand("foreColor", false, selectedColor);
         button.textContent = "Save";
       }
     }

     function completeTask(taskId, button) {
       let taskElement = document.getElementById(taskId);
       let taskName =
         taskElement.querySelector(".task-content").textContent ||
         "Unnamed Task";
       if (taskElement.dataset.completed === "true") {
         completedTasks--;
         taskElement.dataset.completed = "false";
         taskElement.style.textDecoration = "none";
         button.textContent = "Complete";
         button.classList.remove("btn-danger");
         button.classList.add("btn-success");
         logHistory("Uncompleted task", taskName);
       } else {
         completedTasks++;
         taskElement.dataset.completed = "true";
         taskElement.style.textDecoration = "line-through";
         button.textContent = "Uncomplete";
         button.classList.remove("btn-success");
         button.classList.add("btn-danger");
         logHistory("Completed task", taskName);
       }
       updateProgress();
     }

     function completeSubtask(button) {
       let subtaskElement = button.parentElement.parentElement;
       let statusLabel = subtaskElement.querySelector(".status-label");
       let subtaskName =
         subtaskElement.querySelector(".subtask-content").textContent ||
         "Unnamed Subtask";
       if (subtaskElement.dataset.completed === "true") {
         // Uncomplete subtask
         subtaskElement.dataset.completed = "false";
         subtaskElement.style.textDecoration = "none";
         button.textContent = "Complete";
         button.classList.remove("btn-danger");
         button.classList.add("btn-success");
         statusLabel.textContent = "Uncomplete";
         statusLabel.classList.remove("complete");
         statusLabel.classList.add("uncomplete");
         logHistory("Uncompleted subtask", subtaskName);
       } else {
         // Complete subtask
         subtaskElement.dataset.completed = "true";
         subtaskElement.style.textDecoration = "line-through";
         button.textContent = "Uncomplete";
         button.classList.remove("btn-success");
         button.classList.add("btn-danger");
         statusLabel.textContent = "Complete";
         statusLabel.classList.remove("uncomplete");
         statusLabel.classList.add("complete");
         logHistory("Completed subtask", subtaskName);
       }
       // Check if parent task needs to be updated
       let parentTaskId = subtaskElement.parentElement.id;
       checkTaskCompletion(parentTaskId);
     }

     function checkTaskCompletion(taskId) {
       let taskElement = document.getElementById(taskId);
       let subtasks = taskElement.querySelectorAll(".subtask-bar");
       let allSubtasksCompleted = subtasks.length > 0;
       subtasks.forEach((subtask) => {
         if (subtask.dataset.completed !== "true") {
           allSubtasksCompleted = false;
         }
       });
       let completeButton = taskElement.querySelector(
         ".btn-success, .btn-danger"
       );
       if (allSubtasksCompleted) {
         if (taskElement.dataset.completed !== "true") {
           // Mark task as completed
           completedTasks++;
           taskElement.dataset.completed = "true";
           taskElement.style.textDecoration = "line-through";
           completeButton.textContent = "Uncomplete";
           completeButton.classList.remove("btn-success");
           completeButton.classList.add("btn-danger");
           logHistory(
             "Completed task",
             taskElement.querySelector(".task-content").textContent ||
               "Unnamed Task"
           );
           updateProgress();
         }
       } else {
         if (taskElement.dataset.completed === "true") {
           // Uncomplete task
           completedTasks--;
           taskElement.dataset.completed = "false";
           taskElement.style.textDecoration = "none";
           completeButton.textContent = "Complete";
           completeButton.classList.remove("btn-danger");
           completeButton.classList.add("btn-success");
           logHistory(
             "Uncompleted task",
             taskElement.querySelector(".task-content").textContent ||
               "Unnamed Task"
           );
           updateProgress();
         }
       }
     }

     function updateProgress() {
       let progress =
         totalTasks === 0 ? 0 : (completedTasks / totalTasks) * 100;
       document.getElementById("progressBar").style.width = progress + "%";
     }

     function formatText(command, value = null) {
       document.execCommand(command, false, value);
     }

     function changeTextColor(color) {
       selectedColor = color;
       // Update the color of future text input
       document.designMode = "on";
       document.execCommand("foreColor", false, selectedColor);
       document.designMode = "off";
     }

     function showToDo() {
       document.getElementById("progressContainer").style.display = "block";
       document.getElementById("taskList").style.display = "block";
       document.getElementById("historyContent").style.display = "none";
       document.getElementById("designContent").style.display = "none";
       // Update active class
       document.getElementById("todoButton").classList.add("active");
       document.getElementById("historyButton").classList.remove("active");
       document.getElementById("designButton").classList.remove("active");
     }

     function showHistory() {
       document.getElementById("progressContainer").style.display = "none";
       document.getElementById("taskList").style.display = "none";
       document.getElementById("historyContent").style.display = "block";
       document.getElementById("designContent").style.display = "none";
       // Update active class
       document.getElementById("todoButton").classList.remove("active");
       document.getElementById("historyButton").classList.add("active");
       document.getElementById("designButton").classList.remove("active");
       // Load history content
       let historyContent = document.getElementById("historyContent");
       historyContent.innerHTML = "<h3>History</h3>";
       history.forEach((entry) => {
         let p = document.createElement("p");
         p.textContent = entry;
         historyContent.appendChild(p);
       });
     }

     function showDesign() {
       document.getElementById("progressContainer").style.display = "none";
       document.getElementById("taskList").style.display = "none";
       document.getElementById("historyContent").style.display = "none";
       document.getElementById("designContent").style.display = "block";

       document.getElementById("todoButton").classList.remove("active");
       document.getElementById("historyButton").classList.remove("active");
       document.getElementById("designButton").classList.add("active");

       let designContent = document.getElementById("designContent");
       designContent.innerHTML = `
   <h3>Design Settings</h3>
   <div class="form-group">
     <label for="colorScheme">Color Scheme:</label>
     <select id="colorScheme" onchange="changeColorScheme(this.value)" class="form-control">
       <option value="light">Light</option>
       <option value="dark">Dark</option>
     </select>
   </div>
 `;
     }

     function changeColorScheme(scheme) {
       if (scheme === "dark") {
         document.body.classList.add("dark-mode");
       } else {
         document.body.classList.remove("dark-mode");
       }
     }

     function logHistory(action, name) {
       const timestamp = new Date().toLocaleString();
       history.push(`${timestamp} - ${action}: ${name}`);
     }
   </script>
 </body>
</html>






